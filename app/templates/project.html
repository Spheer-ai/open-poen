{% extends "base.html" %}
{% block head %}
  <title>Open Poen - {{ project.name }}</title>
  <meta property="og:title" content="Open Poen - {{ project.name }}" />
  {{ super() }}
{% endblock %}

{% block content %}
  <div>
    <a href="/">Home</a> > {{ project.name }}
  </div>

  ter beschikking door:
  {% for funder in project.funders %}
    <a href="{{ funder.url }}" target="_blank" rel="noopener">{{ funder.name }}</a>
  {% endfor %}

  {% for project_name, project in project_data.items() %}
    <p>{{ project_name }}</p>
    <p>resterend: {{ project.left_str }}</p>
    <p>uitgegeven: {{ project.spent_str }}</p>
    <p>totaal: {{ project.awarded_str }}</p>
    <p>percentage: {{ project.percentage_spent_str }}</p>
  {% endfor %}

  <table>
    <tr>
      <th>waarvoor?</th>
      <th>bedrag â‚¬</th>
      <th>ontvanger</th>
      <th>initiatiefnemer</th>
      <th>omschrijving</th>
      <th>datum</th>
      <th>media</th>
      <th>info</th>
      <th>details</th>
    </tr>
    {% for subproject in project.subprojects %}
      {% for payment in subproject.payments|sort(attribute='created', reverse=true) %}
        <tr>
          <td><a href="{{ url_for('subproject', project_id=project.id, subproject_id=subproject.id) }}">{{ subproject.name }}</a></td>
          <td>{{ payment.amount_value }}</td>
          <td>{{ payment.counterparty_alias_name }}</td>
          <td>{{ payment.alias_name }}</td>
          {% if payment.short_user_description %}
            <td>{{ payment.short_user_description }}</td>
          {% else %}
            <td><i>nog niet toegevoegd</i></td>
          {% endif %}
          <td>{{ payment.created.strftime('%Y-%m-%d') }}</td>
          <td>TODO</td>
          <td>TODO</td>
          <td>TODO</td>
        </tr>
      {% endfor %}
    {% endfor %}
  </table>
{% endblock %}
